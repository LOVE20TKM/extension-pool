# LOVE20 行动扩展协议之矿池扩展协议（初稿）

## 1. 关于协议

此扩展协议，基于 LOVE20 扩展协议标准，扩展行动参与机制，允许矿工以矿池的方式参与行动。

- 矿工可自由加入退出所选矿池，进行可验证的共识行动
- 矿工基于所在矿池的矿池主的验证结果获得行动铸币激励
- 支持此行动的治理者，通过不信任投票降低特定矿池整体收益的方式，来监督和惩罚作弊或违背行动验证规则的矿池

## 2. 初始参数

### 2.1 最小治理票占比

持有大于等于 最小治理票占比 的治理者，可创建矿池成为矿池主

### 2.2 容量倍数

- 单个矿池最小容量：已铸造代币总量 \* 最小治理票占比 \* 容量倍数
- 矿池主矿池累计容量上限：已铸造代币总量 \* 矿池主治理票占比 \* 容量倍数

### 2.3 质押倍数

- 质押量 = 矿池容量 / 质押倍数
- 最大质押量：矿池主矿池的累计质押量上限：矿池主累计矿池容量上限 / 质押倍数

### 2.4 矿工最大参与代币数上限倍数

- 单个矿工最大参与代币数 = 已铸造代币总量 / 矿工最大参与代币上限倍数

## 3. 治理者

### 3.1 不信任投票

完成非弃权票验证的行动治理者，可以在验证阶段可选择性对一个或多个矿池进行不信任投票，每个矿池的不信任票不超过自己的验证票数，以惩罚未按照行动规则进行验证的矿池，降低包括矿池主和矿工在内的矿池整体铸币激励。

对特定矿池投不信任票，需说明原因。

实际矿池铸币率 = 当轮累计获得的不信任票 / 当轮非弃权的行动验证总票数

每个治理者投出不信任票，都将更新本轮：

- 实际矿池总票数 = 所有矿池实际可用票数
- 被投矿池的实际可用票数 = 矿池参与代币总数 \* 实际矿池铸币率

## 4. 矿池主

任何治理者可以在[矿池 ID](https://love20tkm.github.io/pool-id/)里铸造自己的矿池 ID NFT 成为矿池主

### 4.1 矿池启动或恢复

治理者可以选择自己持有的矿池 ID 来启动一个新矿池或恢复旧矿池，启动时需提供：

- 矿池说明：例如：一些注意事项，以及如何联系到矿池主，如何加入所在矿池的矿工群等
- 矿工最小参与量：参与矿池需要至少多少代币
- 矿工最大参与量（可选）：参与矿池最多多少代币

矿池启动时，需无偿质押代币，决定矿池的容量上限。

矿池容量 = 累计质押量 \* 质押倍数

### 4.2 矿池更新

立即更新，并在当轮立即生效（不影响已参与的矿工）

- 矿池说明
- 矿工最小参与量
- 矿工最大参与量

### 4.3 矿池扩容

矿池主可追加质押，增加矿池容量上限。矿工加入矿池时，如果超出矿池容量，将无法加入。

### 4.4 矿池验证

每轮的验证阶段，矿池主基于行动的验证规则，验证自己管理的矿池中每个矿工的可验证共识行动，给予矿池验证票，决定每个矿工的铸币量。

每轮的验证阶段，下面 4 种交互情况任意情况发生，立即在交互前快照所在矿池待验证矿工地址与每个矿工的参与代币数（每轮只触发一次快照生成）， 作为本轮矿池主的验证基准。

- 矿工加入矿池
- 矿工退出矿池
- 矿池主提交矿池验证
- 治理者提交不信任票

注意：

- 所有矿工的验证票总数不得超过矿池参与代币总量
- 若当前轮次矿池主未提交有效的矿池验证，或所有矿工的验证票总数为 0，则自动放弃本矿池所有激励，分给其他矿池

### 4.4 矿池指定验证者

矿池主可为矿池，设定不同的钱包地址作为矿池验证者，矿池验证者和矿池主都可以提交矿池的验证结果。

### 4.5 矿池停止

矿池主在矿池创建后的下一轮开始，可随时停止矿池，并立即返还质押代币。

矿池停止后，矿工可继续领取之前未领取的行动铸币激励。

已停止的矿池，新矿工无法加入，现有矿工也无法追加代币；矿池主也无法提交验证。

## 5. 矿工

### 5.1 加入矿池

矿工可以通过矿池 ID，将代币放入矿池进行挖矿

注意：同一个行动下，只能参与一个矿池的挖矿，不可以同时参与多个矿池。

### 5.2 铸造行动激励

矿工加入后，下一轮开始验证，验证后可铸造自己的行动激励

矿工铸造行动激励 = 矿工本轮得分 / 矿池总得分 \* 矿池实际铸币激励

矿池实际铸币激励 = 行动总激励 \* 矿池实际可投票数 / 实际矿池总票数

### 5.3 退出矿池

可随时退出矿池并立即返还累计参与的所有代币
