# 人工验证链群行动扩展协议（初稿）

## 1. 关于协议

此扩展协议，基于 LOVE20 扩展协议标准，扩展行动参与机制，允许行动者以链群的方式参与行动。

- 行动者可自由加入退出所选链群，进行可验证的共识行动
- 行动者基于所在链群的链群服务者的验证结果获得行动铸币激励
- 支持此行动的治理者，通过不信任投票降低特定链群整体收益的方式，来监督和惩罚作弊或违背行动验证规则的链群

## 2. 初始参数

### 2.1 最小治理票占比

持有大于等于 最小治理票占比 的治理者，可创建链群成为链群服务者

### 2.2 容量倍数

- 单个链群最小容量：已铸造代币总量 \* 最小治理票占比 \* 容量倍数
- 基础容量 = 已铸造代币总量 \* 链群服务者治理票占比
- 链群服务者链群理论容量上限： 基础容量 \* 容量倍数

### 2.3 质押代币合约地址

一般为所在社群的代币合约地址，也可设置为 LP 地址等。

### 2.4 质押倍数

- 质押量 = 链群容量 / 质押倍数
- 最小质押量 = 单个链群最小容量 / 质押倍数
- 最大质押量 = 链群服务者链群理论容量上限 / 质押倍数

### 2.5 最大参与代币倍数

- 单个行动者最大参与代币数 = 已铸造代币总量 / 最大参与代币倍数

### 2.6 最小参与代币量

单个行动者参与行动时，最少需要提供的代币数量

## 3. 治理者

### 3.1 不信任投票

在验证阶段对一个或多个链群服务者进行不信任投票：

- 投票上限：对单个链群服务者的不信任票数 ≤ 自己给扩展协议合约投的验证票数
- 投票目的：惩罚验证不公或有其他作恶行为的链群服务者
- 投票效果：降低该链群服务者所服务的所有链群的铸币激励
- 说明理由：投不信任票时同时提交原因在链上公示

链群验证者的不信任率 = 链群服务者收到的不信任票总数 / 给扩展协议合约投的验证票总数

投不信任票会同步额外更新数据：

- 被投链群服务者已验证的每个链群的得分：链群参与代币总量 \* (1 - 链群验证者的不信任率)
- 行动总得分：已验证链群累计得分

## 4. 链群服务者

有两种方式成为链群服务者

- 在[链群](https://love20tkm.github.io/group/)里铸造自己的链群 NFT 并在链群行动中激活链群成为链群服务者
- 获得已激活的链群对应的 NFT

### 4.1 链群激活或恢复

治理者可以选择自己持有的链群 NFT 来激活一个新链群或恢复旧链群，激活时需提供：

- 链群说明：例如：一些注意事项，以及如何联系到链群服务者，如何加入所在链群的行动者群（例如：QQ 群、微信验证群）等
- 行动者最小参与量
- 行动者最大参与量（可选）：0 为不做限制

链群激活时，需质押代币，决定链群的容量上限。

链群容量 = 累计质押量 \* 质押倍数

恢复链群时，自动继承原链群中所有未退出的行动者

### 4.2 链群更新

立即更新，并在当轮立即生效（不影响已参与的行动者）

- 链群说明
- 行动者最小参与量
- 行动者最大参与量

### 4.3 链群扩容

链群服务者可追加质押，增加链群容量上限。行动者加入链群时，如果超出链群容量，将无法加入。

### 4.4 链群验证

提交验证时，会更新下面 4 类得分

- 行动者得分：每轮的验证阶段，链群服务者（持有链群 NFT ）基于行动的验证规则，提交快照中每个行动者的原始得分\[0~100\]，并计算每个行动者的最终得分：行动者的原始得分 \* 参与代币数量
- 链群内所有行动者总得分：简化后续计算行动者激励的
- 链群得分生成：链群参与代币总量 \* (1 - 链群验证者的不信任率)
- 行动总得分：已验证链群累计得分

每轮的验证阶段，下面 3 种交互情况任意情况发生，立即在交互前生成本轮链群快照（每个链群每轮只触发一次快照生成）：行动代币参与总量、所在链群验证者地址、链群参与代币总量、每个行动者的参与代币数。

- 行动者加入行动
- 行动者退出行动
- 链群服务者提交链群验证

注意：

- 链群快照时对应的链群服务者才可以提交验证结果（指定的代理验证者可代其提交验证结果）
- 链群服务者累计验证的链群容量若超过链群服务者链群理论容量上限，则无法提交验证结果（代理验证者也无法代其提交）
- 若当前轮次链群服务者未能成功提交链群验证，则自动放弃本链群所有激励，分给行动下其他链群

### 4.5 链群指定验证代理

链群服务者可为链群，设定一个钱包地址作为链群验证代理，验证代理可以代替链群服务者提交链群的验证结果。

### 4.6 链群取消激活

链群服务者在链群创建后的下一轮开始，可随时取消激活链群，并立即返还质押代币。

链群取消激活后，行动者可继续领取之前未领取的行动铸币激励。

已取消激活的链群，新行动者无法加入，现有行动者也无法追加代币；链群服务者也无法提交验证。

## 5. 行动者

### 5.1 加入行动

行动者参与行动时，需指定一个链群 ID，参与代币数需满足：

- 不低于初始参数中的最小参与代币量、所选链群行动者最小参与量
- 不超过单个行动者最大参与代币数、所选链群行动者最大参与量

行动者加入链群时，如果超出链群容量，将无法加入

### 5.2 铸造行动激励

行动者加入后，下一轮开始验证，验证后可铸造自己的行动激励

行动者的行动铸币激励 = 行动者得分 / 链群内所有行动者得分 \* 链群铸币激励

链群铸币激励 = 链群得分 / 行动内所有链群得分

### 5.3 退出行动

可随时退出并立即返还累计参与的所有代币

## 6. 特殊情况

若某轮所有链群都未能提交验证，则验证阶段结束后，任何人可触发行动激励销毁，销毁此行动所有可铸造激励，将代币变为未铸造
